# Card Forge ğŸ”¨

**ç°ä»£åŒ–çš„AIè§’è‰²å¡ç®¡ç†CLIå·¥å…·** - è½»æ¾æå–ã€ä»“åº“åŒ–å’Œé‡å»ºè§’è‰²å¡ï¼

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                               â•‘
â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•‘
â•‘  â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â•â•â•â•‘
â•‘  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â•‘
â•‘  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â•‘
â•‘  â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ•‘     â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•‘
â•‘   â•šâ•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•     â•šâ•â•      â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•‘
â•‘                                                                               â•‘
â•‘                    ğŸ”¨ AIè§’è‰²å¡ç®¡ç†å·¥å…· ğŸ”¨                                      â•‘
â•‘                                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

> âš ï¸ **å…¼å®¹æ€§æé†’**: æ­¤é¡¹ç›®ä¸»è¦é’ˆå¯¹ **è§’è‰²å¡V3è§„èŒƒ(CCV3)** è®¾è®¡ï¼Œè§„èŒƒè¯¦è§ [https://github.com/kwaroran/character-card-spec-v3](https://github.com/kwaroran/character-card-spec-v3)ã€‚æ—§ç‰ˆæœ¬åœ¨æŠ€æœ¯ä¸Šå—æ”¯æŒï¼Œä½†ä¸ä¿è¯æ‰€æœ‰åŠŸèƒ½éƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

- **ğŸ“¤ æå–**: ä»PNGæ–‡ä»¶ä¸­è·å–è§’è‰²æ•°æ®å¹¶è½¬æ¢ä¸ºJSONï¼Œå®Œæ•´æ”¯æŒCCV3è§„èŒƒ
- **ğŸ“ ä»“åº“åŒ–**: å°†è§’è‰²å¡è½¬æ¢ä¸ºç‰ˆæœ¬æ§åˆ¶å‹å¥½çš„æ–‡ä»¶ç»“æ„  
- **ğŸ”¨ é‡å»º**: ä»ä»“åº“ç»“æ„é‡æ–°æ„å»ºè§’è‰²å¡ï¼Œå…·å¤‡æ•°æ®å®Œæ•´æ€§éªŒè¯
- **âœ… éªŒè¯**: ä½¿ç”¨Pydanticæ¨¡å‹æ£€æŸ¥è§’è‰²å¡å®Œæ•´æ€§å’Œè§„èŒƒç¬¦åˆæ€§
- **ğŸ“Š åˆ†æ**: è·å–è¯¦ç»†çš„è§’è‰²å¡ä¿¡æ¯å’Œç»Ÿè®¡æ•°æ®
- **âš™ï¸ å¯é…ç½®**: åŸºäºYAMLçš„çµæ´»é…ç½®ç³»ç»Ÿï¼Œæ”¯æŒè‡ªå®šä¹‰å·¥ä½œæµ
- **ğŸ¨ ç°ä»£åŒ–CLI**: ç¾è§‚çš„ç•Œé¢å’Œå®ç”¨çš„å‘½ä»¤ï¼Œæä¾›æ¸…æ™°çš„åé¦ˆ

## ğŸ”§ å®‰è£…

```bash
# ä½¿ç”¨uvå®‰è£…ï¼ˆæ¨èï¼‰
uv add --dev card-forge

# æˆ–ä½¿ç”¨pipå®‰è£…
pip install card-forge
```

## ğŸ¯ å¿«é€Ÿå¼€å§‹

```bash
# ä»PNGæ–‡ä»¶æå–è§’è‰²æ•°æ®
card-forge extract character.png

# å°†è§’è‰²å¡è½¬æ¢ä¸ºä»“åº“ç»“æ„
card-forge repo character.png

# ä»ä»“åº“é‡å»ºè§’è‰²å¡
card-forge build my_character/

# éªŒè¯è§’è‰²å¡
card-forge validate character.png

# è·å–è§’è‰²è¯¦ç»†ä¿¡æ¯
card-forge info character.png
```

## ğŸ—ï¸ æ¶æ„ä¸æ•°æ®æ¨¡å‹

Card Forge åŸºäºå¼ºå¤§çš„ **Pydantic v2** æ¨¡å‹æ„å»ºï¼Œç¡®ä¿æ•´ä¸ªå·¥ä½œæµç¨‹ä¸­çš„æ•°æ®å®Œæ•´æ€§å’Œç±»å‹å®‰å…¨ã€‚æˆ‘ä»¬çš„æ¨¡å‹æä¾›ï¼š

- **å®Œæ•´çš„CCV3åˆè§„æ€§**: å®Œæ•´å®ç°è§’è‰²å¡V3è§„èŒƒ
- **ç±»å‹å®‰å…¨**: æ‰€æœ‰è§’è‰²æ•°æ®éƒ½ä½¿ç”¨å¼ºç±»å‹Pydanticæ¨¡å‹è¿›è¡ŒéªŒè¯
- **æ•°æ®å®Œæ•´æ€§**: åœ¨æå–ã€ä»“åº“åŒ–å’Œé‡å»ºè¿‡ç¨‹ä¸­è‡ªåŠ¨éªŒè¯
- **å¯æ‰©å±•æ€§**: æ”¯æŒè‡ªå®šä¹‰æ‰©å±•å’Œåº”ç”¨ç¨‹åºç‰¹å®šå­—æ®µ

### æ ¸å¿ƒæ¨¡å‹

```python
from forge.models import CharacterCardV3, CharacterCardV3Data, Lorebook, LorebookEntry, Asset

# æ‰€æœ‰è§’è‰²å¡éƒ½è¡¨ç¤ºä¸ºç»è¿‡éªŒè¯çš„Pydanticæ¨¡å‹
card: CharacterCardV3 = extract_card_data("character.png")

# è®¿é—®ç±»å‹åŒ–æ•°æ®ï¼Œå…·å¤‡å®Œæ•´çš„IDEæ”¯æŒå’ŒéªŒè¯
character_name: str = card.data.name
lorebook: Optional[Lorebook] = card.data.character_book
assets: Optional[List[Asset]] = card.data.assets
```

**æ¨¡å‹ç‰¹æ€§ï¼š**
- **è‡ªåŠ¨éªŒè¯**: æ— æ•ˆæ•°æ®ä¼šè¢«åŠæ—©å‘ç°ï¼Œå¹¶æä¾›æ¸…æ™°çš„é”™è¯¯æ¶ˆæ¯
- **ç±»å‹æç¤º**: å®Œæ•´çš„IDEæ”¯æŒï¼ŒåŒ…æ‹¬è‡ªåŠ¨å®Œæˆå’Œç±»å‹æ£€æŸ¥
- **çµæ´»å­—æ®µ**: æ”¯æŒå¯é€‰å­—æ®µã€é»˜è®¤å€¼å’Œè‡ªå®šä¹‰æ‰©å±•
- **JSONåºåˆ—åŒ–**: Pythonå¯¹è±¡å’ŒJSONä¹‹é—´çš„æ— ç¼è½¬æ¢

## ğŸ“‹ å‘½ä»¤å‚è€ƒ

### æå–å‘½ä»¤
```bash
card-forge extract card.png                     # æå–åˆ° character_name.json
card-forge extract card.png -o mychar.json      # è‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶å
```

### ä»“åº“å‘½ä»¤
```bash
card-forge repo card.png                        # ä»PNGæ–‡ä»¶
card-forge repo character.json                  # ä»JSONæ–‡ä»¶
card-forge repo card.png -c custom_config.yaml  # ä½¿ç”¨è‡ªå®šä¹‰é…ç½®
```

**ä»“åº“ç»“æ„ï¼š**
```
character_name/
â”œâ”€â”€ _metadata.yaml              # è§’è‰²å¡å…ƒæ•°æ®ï¼ˆè§„æ ¼ã€ç‰ˆæœ¬ï¼‰
â””â”€â”€ data/
    â”œâ”€â”€ _metadata.yaml          # å‰©ä½™è§’è‰²æ•°æ®
    â”œâ”€â”€ description.md          # è§’è‰²æè¿°
    â”œâ”€â”€ personality.md          # æ€§æ ¼ç‰¹å¾
    â”œâ”€â”€ scenario.md             # åœºæ™¯æè¿°
    â”œâ”€â”€ system_prompt.md        # ç³»ç»ŸæŒ‡ä»¤
    â”œâ”€â”€ first_message.md        # é¦–æ¡æ¶ˆæ¯
    â”œâ”€â”€ example_messages.md     # ç¤ºä¾‹å¯¹è¯
    â”œâ”€â”€ creator_notes.md        # åˆ›ä½œè€…å¤‡æ³¨
    â”œâ”€â”€ alternate_greetings/    # æ›¿ä»£é—®å€™è¯­
    â”‚   â”œâ”€â”€ 001.md
    â”‚   â””â”€â”€ 002.md
    â”œâ”€â”€ group_only_greetings/   # ç¾¤èŠä¸“ç”¨é—®å€™è¯­
    â”‚   â””â”€â”€ 001.md
    â”œâ”€â”€ creator_notes_multilingual/  # å¤šè¯­è¨€å¤‡æ³¨
    â”‚   â”œâ”€â”€ en.md
    â”‚   â””â”€â”€ es.md
    â”œâ”€â”€ assets/                 # è§’è‰²ç´ æ
    â”‚   â”œâ”€â”€ main_icon.yaml
    â”‚   â””â”€â”€ background_image.yaml
    â”œâ”€â”€ extensions/             # æ‰©å±•å’Œè„šæœ¬
    â”‚   â”œâ”€â”€ _metadata.yaml
    â”‚   â”œâ”€â”€ TavernHelper_scripts/
    â”‚   â”‚   â””â”€â”€ 001_script_name.yaml
    â”‚   â””â”€â”€ regex_scripts/
    â”‚       â””â”€â”€ 001_script_name.yaml
    â””â”€â”€ character_book/         # è®¾å®šé›†æ¡ç›®
        â”œâ”€â”€ _metadata.yaml
        â””â”€â”€ entries/
            â”œâ”€â”€ 001_location.yaml
            â””â”€â”€ 002_character.yaml
```

### æ„å»ºå‘½ä»¤
```bash
card-forge build my_character/                  # é‡å»ºä¸ºJSON
card-forge build my_character/ -f png           # é‡å»ºä¸ºPNG
card-forge build my_character/ -o rebuilt       # è‡ªå®šä¹‰è¾“å‡ºåç§°
card-forge build my_character/ -f png -b base.png  # è‡ªå®šä¹‰åŸºç¡€å›¾ç‰‡
```

### éªŒè¯ä¸åˆ†æ
```bash
card-forge validate character.png               # éªŒè¯PNG
card-forge validate character.json              # éªŒè¯JSON
card-forge info character.png                   # æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
```

### é…ç½®
```bash
card-forge init-config                          # ç”Ÿæˆ config.yaml
card-forge init-config -o custom.yaml           # è‡ªå®šä¹‰æ–‡ä»¶å
```

## ğŸ› ï¸ å¼€å‘å·¥ä½œæµç¨‹

**1. æå–å’Œæ¢ç´¢**
```bash
card-forge extract my_card.png
card-forge info my_card.png
```

**2. è½¬æ¢ä¸ºä»“åº“**
```bash
card-forge repo my_card.png
```

**3. ç¼–è¾‘æ–‡ä»¶** - åœ¨æ‚¨å–œæ¬¢çš„ç¼–è¾‘å™¨ä¸­ç¼–è¾‘å„ä¸ªæ–‡ä»¶

**4. é‡å»ºå’Œæµ‹è¯•**
```bash
card-forge build my_character/
card-forge validate my_character_rebuilt.json
card-forge build my_character/ -f png
```

## ğŸ”„ å¸¸è§ä½¿ç”¨åœºæ™¯

### è§’è‰²å¼€å‘çš„ç‰ˆæœ¬æ§åˆ¶
```bash
card-forge repo character.png
git init character_name && cd character_name
git add . && git commit -m "åˆå§‹è§’è‰²å¯¼å…¥"
# å¯¹æ–‡ä»¶è¿›è¡Œæ›´æ”¹...
git commit -am "æ›´æ–°æ€§æ ¼ç‰¹å¾"
card-forge build . -f png
```

### åä½œè§’è‰²åˆ›ä½œ
```bash
card-forge repo base_character.png
# å›¢é˜Ÿæˆå‘˜åˆ†å·¥å¤„ç†ä¸åŒæ–‡ä»¶
# Aè´Ÿè´£ personality.mdï¼ŒBè´Ÿè´£è®¾å®šé›†æ¡ç›®ï¼ŒCè´Ÿè´£é—®å€™è¯­
card-forge build character/ -f png
```

### è§’è‰²åˆ†æå’Œè°ƒè¯•
```bash
card-forge info problematic_card.png
card-forge validate character.png
```

## ğŸ“¦ APIä½¿ç”¨

**ä½¿ç”¨Pydanticæ¨¡å‹è¿›è¡Œç¨‹åºåŒ–è®¿é—®ï¼š**

```python
from forge.helper import extract_card_data, repositorize, rebuild_card
from forge.models import CharacterCardV3

# æå–è§’è‰²å¡ï¼Œå…·å¤‡å®Œæ•´çš„ç±»å‹å®‰å…¨
card: CharacterCardV3 = extract_card_data("character.png")

# è®¿é—®ç»è¿‡éªŒè¯çš„æ•°æ®
print(f"è§’è‰²: {card.data.name}")
print(f"åˆ›ä½œè€…: {card.data.creator}")
print(f"è®¾å®šé›†æ¡ç›®: {len(card.data.character_book.entries) if card.data.character_book else 0}")

# è½¬æ¢ä¸ºä»“åº“ç»“æ„  
repo_path: str = repositorize(card)

# åœ¨ä»“åº“ä¸­ç¼–è¾‘æ–‡ä»¶...

# é‡å»ºå¹¶éªŒè¯
rebuilt_card: CharacterCardV3 = rebuild_card(repo_path)
```

## âš™ï¸ é…ç½®ç³»ç»Ÿ

Card Forge ä½¿ç”¨çµæ´»çš„åŸºäºYAMLçš„é…ç½®ç³»ç»Ÿï¼Œç”¨äºè‡ªå®šä¹‰è§’è‰²æ•°æ®å¦‚ä½•ç»„ç»‡æˆæ–‡ä»¶å’Œç›®å½•ã€‚

### å­—æ®µç±»å‹å’Œé€‰é¡¹

```yaml
repositorize:
  fields:
    field_name:
      enabled: true/false          # æ˜¯å¦å¤„ç†æ­¤å­—æ®µ
      type: string|array|dict|nested  # å¦‚ä½•å¤„ç†æ•°æ®
      filename: "custom.md"        # ç”¨äºå­—ç¬¦ä¸²ç±»å‹
      file_pattern: "{template}"   # ç”¨äºæ•°ç»„å’Œå­—å…¸
      value_type: string|dict      # æ•°ç»„/å­—å…¸ä¸­å€¼çš„ç±»å‹
```

### æ¨¡æ¿å˜é‡

- `{idx}` - æ•°ç»„ç´¢å¼•ï¼ˆè‡ªåŠ¨è¡¥é›¶ï¼‰
- `{value.name}` - ä½¿ç”¨ç‚¹æ ‡è®°æ³•è®¿é—®åµŒå¥—å±æ€§
- `{value.id}_{value.title}` - ç»„åˆå¤šä¸ªå±æ€§

### é…ç½®ç¤ºä¾‹

**è‡ªå®šä¹‰æ•°ç»„æ¨¡å¼ï¼š**
```yaml
alternate_greetings:
  enabled: true
  type: array
  file_pattern: "greeting_{idx}.md"
  value_type: string
```

**å¤æ‚å¯¹è±¡æ•°ç»„ï¼š**
```yaml
assets:
  enabled: true
  type: array
  file_pattern: "{name}_{type}.yaml"
  value_type: dict
```

**å¤šè¯­è¨€å†…å®¹ï¼š**
```yaml
creator_notes_multilingual:
  enabled: true
  type: dict
  file_pattern: "notes_{key}.md"
  value_type: string
```

## ğŸ® å…¼å®¹æ€§

- âœ… **SillyTavern**: å®Œå…¨å…¼å®¹
- âœ… **RisuAI**: å®Œå…¨å…¼å®¹  
- âœ… **Character Card V3**: å®Œæ•´è§„èŒƒæ”¯æŒ
- âœ… **ä¼ ç»Ÿæ ¼å¼**: å‘åå…¼å®¹

## ğŸ¤ è´¡çŒ®

1. Fork ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯  
3. è¿›è¡Œæ›´æ”¹
4. ä¸ºæ–°åŠŸèƒ½æ·»åŠ æµ‹è¯•
5. æäº¤ Pull Request

## ğŸ“„ è®¸å¯è¯

MITè®¸å¯è¯ - è¯¦è§LICENSEæ–‡ä»¶ã€‚

---

**Card Forge** - è®©è§’è‰²å¡ç®¡ç†å˜å¾—ç®€å•ã€æœ‰åºä¸”ç‰ˆæœ¬æ§åˆ¶å‹å¥½ï¼ ğŸ­âœ¨